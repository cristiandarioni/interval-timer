<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interval Timer</title>

<style>
  body {
    margin: 0;
    height: 100vh;
    background: #000;
    color: #fff;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .screen {
    display: none;
    width: 100%;
    text-align: center;
  }

  .active {
    display: block;
  }

  input {
    padding: 12px;
    margin: 8px;
    font-size: 16px;
    width: 140px;
    border-radius: 8px;
    border: none;
    text-align: center;
  }

  button {
    padding: 14px 18px;
    font-size: 16px;
    border: none;
    border-radius: 10px;
    margin: 8px;
    cursor: pointer;
  }

  .start { background: #2ecc71; }
  .pause { background: #f1c40f; }
  .reset { background: #e74c3c; }

  .label {
    font-size: 22px;
    letter-spacing: 1px;
    margin-bottom: 10px;
  }

  .time {
    font-size: 90px;
    font-weight: bold;
    margin: 20px 0;
  }

  .cycle {
    opacity: 0.7;
    margin-bottom: 20px;
  }
</style>
</head>

<body>

<!-- PANTALLA INICIAL -->
<div id="setupScreen" class="screen active">
  <h2>Configurar Ciclos</h2>

  <input id="shortInput" type="number" placeholder="Retorno (s)" value="17"><br>
  <input id="longInput" type="number" placeholder="Extracción (s)" value="43"><br>
  <input id="cyclesInput" type="number" placeholder="Ciclos" value="6"><br>

  <button class="start" onclick="startSession()">Comenzar</button>
</div>

<!-- PANTALLA TIMER -->
<div id="timerScreen" class="screen">
  <div class="label" id="phaseLabel">RETORNO</div>
  <div class="time" id="time">0</div>
  <div class="cycle" id="cycleLabel">Ciclo 1</div>

  <button class="pause" onclick="pauseTimer()">Pausar</button>
  <button class="reset" onclick="resetAll()">Reiniciar</button>
</div>

<script>
  let shortTime = 17;
  let longTime = 43;
  let totalCycles = 1;

  let currentPhase = "short"; // short / long
  let timeRemaining = 0;
  let currentCycle = 1;
  let running = false;
  let timer = null;

  const setupScreen = document.getElementById("setupScreen");
  const timerScreen = document.getElementById("timerScreen");

  const timeEl = document.getElementById("time");
  const phaseEl = document.getElementById("phaseLabel");
  const cycleEl = document.getElementById("cycleLabel");

  function startSession() {
    shortTime = parseInt(document.getElementById("shortInput").value);
    longTime = parseInt(document.getElementById("longInput").value);
    totalCycles = parseInt(document.getElementById("cyclesInput").value);

    currentPhase = "short";
    timeRemaining = shortTime;
    currentCycle = 1;

    setupScreen.classList.remove("active");
    timerScreen.classList.add("active");

    updateUI();
    running = true;
    timer = setInterval(tick, 1000);
  }

  function tick() {
    if (!running) return;

    timeRemaining--;

    if (timeRemaining < 0) {
      if (currentPhase === "short") {
        currentPhase = "long";
        timeRemaining = longTime;
      } else {
        currentCycle++;
        if (currentCycle > totalCycles) {
          finishSession();
          return;
        }
        currentPhase = "short";
        timeRemaining = shortTime;
      }
      vibrate();
    }

    updateUI();
  }

  function updateUI() {
    timeEl.textContent = timeRemaining;
    phaseEl.textContent = currentPhase === "short" ? "RETORNO" : "EXTRACCIÓN";
    cycleEl.textContent = `Ciclo ${currentCycle} de ${totalCycles}`;

    document.body.style.background =
      currentPhase === "short" ? "#0a1a2f" : "#2a0a1f";
  }

  function pauseTimer() {
    running = !running;
  }

  function resetAll() {
    clearInterval(timer);
    running = false;
    setupScreen.classList.add("active");
    timerScreen.classList.remove("active");
  }

  function finishSession() {
    clearInterval(timer);
    phaseEl.textContent = "FINALIZADO";
    running = false;
    vibrate();
  }

  function vibrate() {
    if (navigator.vibrate) navigator.vibrate(200);
  }
</script>

</body>
</html>
